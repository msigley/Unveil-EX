/**
 * jQuery Unveil EX
 * 1.0.0
 * A lightweight and feature rich plugin to lazy load images.
 *
 * Licensed under the MIT license.
 * By Matthew Sigley
 * https://github.com/msigley/
 */
(function(a){a.unveilGetIEVersion=function(){var a="undefined"!==typeof navigator?navigator.userAgent:"";return/msie|trident/i.test(a)?(a=a.match(/(?:msie |rv:)(\d+(\.\d+)?)/i))&&1<a.length&&a[1]||"":""};var d="";d=bowser.msie?bowser.version:a.unveilGetIEVersion();a.unveilCallIndex=0;a.unveilCallStack=[];a.unveilEventTimers=[];a.unveilMutationObserver=!1;a.unveilPrintText=!1;a.unveilPrintEventsLeft=!1;a.unveilPrintEventsCallPrintAfter=!1;a.unveilIsImageLoaded=function(a){return!a.complete||"undefined"!=
typeof a.naturalWidth&&0==a.naturalWidth?!1:!0};a.unveilIsVisible=function(a){if(null===a.offsetParent)return!1;if(""!==d&&11>d){var b="";"undefined"!=typeof getComputedStyle?b=window.getComputedStyle(a).display:"undefined"!=typeof a.currentStyle&&(b=a.currentStyle.display);if("none"==b||"fixed"==b||"absolute"==b)return!1}return!0};a.unveilInDOM=function(a){return document.body.contains(a)};a.unveilHasEvent=function(b){return(b=a._data(b,"events"))&&b.unveil?!0:!1};a.unveilImagesInView=function(){a.unveilCallStack.forEach(function(a){a()})};
a.unveilAndPrint=function(){var b=a("img").not(".no-lazy-load img").filter(function(){return a.unveilHasEvent(this)});a.unveilPrintEventsLeft=b.length;0<a.unveilPrintEventsLeft?(a.unveilPrintEventsCallPrintAfter=!0,b.trigger("unveil")):window.print()};a.fn.unveil=function(b,d){var g=a(window),k=b||0,c=this;if(!a.unveilMutationObserver&&"MutationObserver"in window){var n=function(l){var f;for(f=0;f<l.length;f++){var b=l[f];var c;for(c=0;c<b.addedNodes.length;c++)if(1===b.addedNodes[c].nodeType){var d=
a(b.addedNodes[c]);d.has("img")&&d.find("img").trigger("unveil")}}};a.unveilMutationObserver=new MutationObserver(function(a){setTimeout(n,0,a)});a.unveilMutationObserver.observe(document.body,{childList:!0,subtree:!0})}"complete"!=document.readyState&&c.each(function(){var b=a(this);dataSource=this.getAttribute("data-src");dataSourceSet=this.getAttribute("data-srcset");if(!(dataSource||dataSourceSet||a.unveilIsImageLoaded(this))&&(a.unveilMutationObserver||a.unveilIsVisible(this))){var f=this.getAttribute("src"),
c=this.getAttribute("srcset");f&&(this.setAttribute("data-src",f),this.setAttribute("src",""));c&&(this.setAttribute("data-srcset",c),this.setAttribute("srcset",""));f=b.get(0).cloneNode(!0);f.width||(b.width(1),this.setAttribute("data-fake-width",!0));f.height||(b.height(1),this.setAttribute("data-fake-height",!0));"inline"==b.css("display")&&b.css("display","inline-block")}});a.unveilPrintText||(a.unveilPrintText=a('<h1 class="print-only">Images not loaded yet. Please close and reopen your print preview.</h1>'),
a.unveilPrintText.css("color","#fff"),a.unveilPrintText.hide().prependTo(document.body));c.one("unveil",function(){var b=a(this),c=this.getAttribute("data-src"),e=this.getAttribute("data-srcset");c&&(this.setAttribute("src",c),this.removeAttribute("data-src"));e&&(this.setAttribute("srcset",e),this.removeAttribute("data-srcset"));this.getAttribute("data-fake-width")&&(b.width("auto"),this.removeAttribute("data-fake-width"));this.getAttribute("data-fake-height")&&(b.height("auto"),this.removeAttribute("data-fake-height"));
(c||e)&&"function"===typeof d&&d.call(this);!1!==a.unveilPrintEventsLeft&&setTimeout(function(){a.unveilPrintEventsLeft--;1>a.unveilPrintEventsLeft&&(a.unveilPrintText&&a.unveilPrintText.remove(),a.unveilPrintEventsCallPrintAfter&&window.print())},1E3)});var e=a.unveilCallIndex,h=function(){clearTimeout(a.unveilEventTimers[e]);var b=c.filter(function(){var b=a(this);if(!a.unveilIsVisible(this))return!a.unveilMutationObserver;var c=g.scrollTop(),e=c+g.height(),d=b.offset().top;return d+b.height()>=
c-k&&d<=e+k}).trigger("unveil");c=c.not(b);c=c.filter(function(){return a.unveilInDOM(this)});c=c.filter(function(){return a.unveilHasEvent(this)});c.length||g.off(".unveil"+e)};a.unveilCallStack.push(h);var p=function(){var b=a("img").not(".no-lazy-load img").filter(function(){return a.unveilHasEvent(this)});b.length?(a.unveilPrintEventsLeft=b.length,a.unveilPrintText&&a.unveilPrintText.show(),b.trigger("unveil")):a.unveilPrintText&&a.unveilPrintText.remove()};g.on("scroll.unveil"+e+" resize.unveil"+
e,function(){clearTimeout(a.unveilEventTimers[e]);a.unveilEventTimers[e]=setTimeout(h,20)});h();var m=function(){window.removeEventListener("beforeprint",m);p()};window.addEventListener("beforeprint",m);a.unveilCallIndex++;return this}})(window.jQuery||window.Zepto);
